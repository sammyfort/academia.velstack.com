var h=Object.defineProperty;var l=(a,r,e)=>r in a?h(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e;var u=(a,r,e)=>l(a,typeof r!="symbol"?r+"":r,e);import{r as n,W as c}from"./app-CgxblWlw.js";var s,d=(s=class{constructor(r){u(this,"_path");u(this,"_params",{});this._path=r}static defineAliases(r){s.aliases=r}filter(r,e){return this.createOrUpdateParams(`filter[${r}]`,[e]),this}sort(...r){return this.createOrUpdateParams("sort",r),this}include(...r){return this.createOrUpdateParams("include",r),this}append(...r){return this.createOrUpdateParams("append",r),this}param(r,...e){return this.createOrUpdateParams(r,e),this}fields(r){return Object.entries(r).forEach(([e,t])=>{this.createOrUpdateParams(`fields[${e}]`,t)}),this}page(r){return this._params.page=[r.toString()],this}when(r,e){return r&&e(this),this}forgetValue(r,e){return this._params[r]||(r=this.parseKeyToAlias(r)),this._params[r]=(this._params[r]||[]).filter(t=>t!==e),this}forget(r){return this._params[r]||(r=this.parseKeyToAlias(r)),delete this._params[r],this}forgets(...r){return r.forEach(e=>{this.forget(e)}),this}createOrUpdateParams(r,e){return r=this.parseKeyToAlias(r),this._params[r]=[...this._params[r]||[],...e],this}parseKeyToAlias(r){return Object.entries(s.aliases).forEach(([e,t])=>{r.includes(e)&&(r=r.replace(e,t))}),r}tap(r){return r(this),this}scopes(...r){return r.forEach(e=>e(this)),this}buildParams(r){const e=this._params[r];return e?`${r}=${e.join(",")}`:""}buildAsArray(r){let e=[];return r!=null&&r.includePath&&e.push(this._path),Object.keys(this._params).map(t=>{var i;(i=r==null?void 0:r.excludes)!=null&&i.includes(t)||!(r!=null&&r.includePagination)&&(t==="page"||t==="limit")||e.push(this.buildParams(t))}),e}build(){const r=Object.keys(this._params).map(t=>this.buildParams(t));let e=this.shouldHaveQmark()?"?":"";return`${this._path}${e}${this.connectQueryString(...r)}`}shouldHaveQmark(){return Object.keys(this._params).length>0}connectQueryString(...r){return r.filter(e=>e.length>0).join("&")}},u(s,"aliases",{}),s),m=d,p=(a="/")=>new m(a);function g(a){const r=n(null);return{filteredQuery:r,runFilter:()=>{const t=p();a.buildQuery(t);const i=t.build().replace("/","");r.value=i==="/"?null:i,c.visit(route(a.routeName)+decodeURIComponent(r.value||""),{preserveScroll:!0,only:a.preserveKeys,onStart:()=>a.form.processing=!0,onFinish:()=>a.form.processing=!1})}}}export{g as u};
