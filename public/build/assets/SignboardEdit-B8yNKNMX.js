import{d as U,x as h,r as u,y as k,f as w,c as R,o as S,a as n,u as m,g as L,w as O,b as I,F as E}from"./app-DyCAOEsR.js";import{t as F,a as j}from"./helpers-BUtTssmL.js";import{_ as G}from"./Layout.vue_vue_type_script_setup_true_lang-CDlHEVP2.js";import{_ as P}from"./SignboardForm.vue_vue_type_script_setup_true_lang-Dwq0mnpy.js";import{_ as x}from"./PageHeader.vue_vue_type_script_setup_true_lang-DbhzSmJC.js";import{P as B}from"./pen-line-Dw__YzeF.js";import"./index-ClKjS9K0.js";import"./Input.vue_vue_type_script_setup_true_lang-Bbk3ZW-K.js";import"./createLucideIcon-Cyy_KDjk.js";import"./useForwardPropsEmits-DfePfLgl.js";import"./chevron-down-ClcGlocs.js";import"./DialogPortal-C_It-rl6.js";import"./x-DndWtt8i.js";import"./InputText.vue_vue_type_script_setup_true_lang-97uQ5q1Y.js";import"./Label.vue_vue_type_script_setup_true_lang-D7wpMv-6.js";import"./map-pin-CrZtk065.js";import"./building-2-BO3JcoTo.js";import"./InputSelect.vue_vue_type_script_setup_true_lang-N6iIeyGO.js";import"./ImageUpload.vue_vue_type_script_setup_true_lang-DE2Xi2vc.js";import"./upload-uqz1W0Xs.js";import"./GalleryUpload.vue_vue_type_script_setup_true_lang-C_t6HREQ.js";import"./plus-lMiiT5vI.js";import"./check-3Wcg5uFf.js";const W={class:"w-full bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50"},le=U({__name:"SignboardEdit",props:{signboard:{},categories:{},regions:{},businesses:{}},setup(d){const s=d,r=h({business_id:"",name:"",region_id:"",categories:[],town:"",street:"",landmark:"",blk_number:"",gps:"",featured_image:null,gallery_images:[],removed_gallery_urls:[]}),i=u(s.signboard.featured_url||null),g=u([...s.signboard.gallery_urls||[]]),l=u([]),c=k(()=>Object.keys(r.errors).filter(e=>e.startsWith("gallery_images.")).map(e=>r.errors[e]));w(()=>{var e;r.name=s.signboard.name,r.business_id=String(s.signboard.business_id),r.region_id=String(s.signboard.region_id),r.categories=((e=s.signboard.categories)==null?void 0:e.map(a=>a.id))||[],r.town=s.signboard.town||"",r.street=s.signboard.street||"",r.landmark=s.signboard.landmark||"",r.blk_number=s.signboard.blk_number||"",r.gps=s.signboard.gps||"",l.value=(s.signboard.gallery_urls||[]).map((a,t)=>({url:a,isOriginal:!0,originalIndex:t}))});const p=()=>{r.post(route("my-signboards.update",s.signboard.id),{forceFormData:!0,onSuccess:e=>{const a=e.props.message;e.props.success?(F(a),r.removed_gallery_urls=[]):j(a)},preserveScroll:!0})},b=e=>{var t;const a=((t=e.target.files)==null?void 0:t[0])||null;r.featured_image=a,i.value&&i.value.startsWith("blob:")&&URL.revokeObjectURL(i.value),i.value=a?URL.createObjectURL(a):null},f=()=>{r.featured_image=null,i.value&&i.value.startsWith("blob:")&&URL.revokeObjectURL(i.value),i.value=null},v=e=>{(e.target.files?Array.from(e.target.files):[]).forEach(t=>{const o=URL.createObjectURL(t);r.gallery_images.push(t),l.value.push({url:o,isOriginal:!1})}),g.value=l.value.map(t=>t.url),e.target.value=""},_=e=>{const a=l.value[e];if(a.isOriginal)r.removed_gallery_urls.push(a.url);else{const t=a.url;URL.revokeObjectURL(t);const o=l.value.slice(0,e).filter(y=>!y.isOriginal).length;o<r.gallery_images.length&&r.gallery_images.splice(o,1)}l.value.splice(e,1),g.value=l.value.map(t=>t.url)};return(e,a)=>(S(),R(E,null,[n(m(L),{title:"Edit Signboard"}),n(G,null,{default:O(()=>[I("div",W,[n(x,{title:"Edit Signboard",subtitle:"Update your signboard listing information",icon:m(B)},null,8,["icon"]),n(P,{form:m(r),categories:e.categories,regions:e.regions,businesses:e.businesses,"business-field-disabled":!0,"featured-preview":i.value,"gallery-previews":g.value,"gallery-items":l.value,"gallery-errors":c.value,"submit-text":"Update Signboard","processing-text":"Updating Signboard...",onHandleFeaturedImage:b,onRemoveFeatured:f,onHandleGalleryImages:v,onRemoveGalleryImage:_,onSubmit:p},null,8,["form","categories","regions","businesses","featured-preview","gallery-previews","gallery-items","gallery-errors"])])]),_:1})],64))}});export{le as default};
