import{d as E,r as b,q as h,f as R,I as F,s as $,c as r,o,j as g,i as p,b as n,w as k,e as C,t as d,u as c,n as _,a as y,F as N,h as O,C as K,L as P,l as S,z as U}from"./app-ClZH-VMP.js";import{f as q,d as I,_ as Q}from"./Input.vue_vue_type_script_setup_true_lang-CZJevDGl.js";import{_ as X}from"./index-DceVIikG.js";import{C as G}from"./Layout.vue_vue_type_script_setup_true_lang-CB7ts7VA.js";import{S as H}from"./search-irQg4COX.js";import{P as J}from"./plus-D9kQ1HKR.js";import{X as W}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BaPIeRDJ.js";const Y={class:"space-y-2"},Z={class:"flex flex-1 flex-wrap items-center gap-1"},ee={key:1},te={key:2,class:"text-muted-foreground"},se={key:0,class:"absolute z-50 mt-1 w-full rounded-md border bg-white shadow-lg overflow-hidden"},oe={key:0,class:"p-2 border-b"},ae={class:"relative"},le={class:"max-h-60 overflow-y-auto"},re=["onClick"],ne={key:0,class:"w-4 h-4 bg-primary rounded-full flex items-center justify-center"},ie={key:1,class:"px-3 py-2 text-sm text-gray-500 text-center"},he=E({__name:"TagSelect",props:{form:{},model:{},label:{},placeholder:{default:"Select options..."},options:{default:()=>[]},size:{default:"unlimited"},searchable:{type:Boolean,default:!0},addable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup(T){const t=T,l=b(""),i=b(!1),w=b(),u=b([...t.options]),f=h(()=>t.size!==1),x=h(()=>t.size==="unlimited"||!f.value?!1:Array.isArray(t.form[t.model])&&t.form[t.model].length>=t.size),m=h(()=>f.value?Array.isArray(t.form[t.model])?t.form[t.model]:[]:t.form[t.model]?[t.form[t.model]]:[]),j=h(()=>!t.searchable||!l.value?u.value:u.value.filter(e=>e.label.toLowerCase().includes(l.value.toLowerCase()))),L=h(()=>j.value.filter(e=>!m.value.includes(e.value)));function z(e){w.value&&!w.value.contains(e.target)&&(i.value=!1)}R(()=>{document.addEventListener("click",z)}),F(()=>{document.removeEventListener("click",z)}),$(()=>t.options,e=>{u.value=[...e]},{immediate:!0}),$(i,e=>{e||(l.value="")});function B(e){if(f.value){const s=Array.isArray(t.form[t.model])?[...t.form[t.model]]:[];!s.includes(e)&&!x.value&&(s.push(e),t.form[t.model]=s)}else t.form[t.model]=e,i.value=!1}function M(e){f.value?t.form[t.model]=t.form[t.model].filter(s=>s!==e):t.form[t.model]=""}function A(){if(!t.addable)return;const e=l.value.trim();if(!e)return;u.value.some(v=>v.label.toLowerCase()===e.toLowerCase())||u.value.push({label:e,value:e}),B(e),l.value=""}function V(e){var s;return((s=u.value.find(v=>v.value===e))==null?void 0:s.label)||e}return(e,s)=>{var v;return o(),r("div",Y,[e.label?(o(),g(c(q),{key:0},{default:k(()=>[C(d(e.label),1)]),_:1})):p("",!0),n("div",{class:"relative",ref_key:"dropdownRef",ref:w},[n("div",{onClick:s[0]||(s[0]=a=>!e.disabled&&(i.value=!i.value)),class:_(["flex min-h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm cursor-pointer",{"cursor-not-allowed opacity-50":e.disabled}])},[n("div",Z,[f.value&&m.value.length>0?(o(!0),r(N,{key:0},O(m.value,a=>(o(),g(c(X),{key:a,variant:"secondary",class:"gap-1"},{default:k(()=>[C(d(V(a))+" ",1),y(c(Q),{onClick:S(D=>M(a),["stop"]),variant:"ghost",size:"sm",class:"h-auto p-0.5 hover:bg-destructive hover:text-destructive-foreground"},{default:k(()=>[y(c(W),{class:"h-3 w-3"})]),_:2},1032,["onClick"])]),_:2},1024))),128)):!f.value&&m.value.length>0?(o(),r("span",ee,d(V(m.value[0])),1)):(o(),r("span",te,d(e.placeholder),1))]),y(c(G),{class:_(["h-4 w-4 shrink-0 opacity-50 transition-transform duration-200",{"rotate-180":i.value}])},null,8,["class"])],2),i.value&&!e.disabled?(o(),r("div",se,[e.searchable?(o(),r("div",oe,[n("div",ae,[y(c(H),{class:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),K(n("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>l.value=a),onKeyup:U(A,["enter"]),onClick:s[2]||(s[2]=S(()=>{},["stop"])),placeholder:"Search or add new...",class:"w-full pl-8 pr-2 py-2 text-sm border rounded focus:outline-none focus:ring-2 focus:ring-ring"},null,544),[[P,l.value]])])])):p("",!0),n("div",le,[(o(!0),r(N,null,O(L.value,a=>(o(),r("div",{key:a.value,onClick:D=>B(a.value),class:_(["px-3 py-2 text-sm cursor-pointer hover:bg-gray-100 flex items-center justify-between",{"pointer-events-none opacity-50":x.value}])},[n("span",null,d(a.label),1),m.value.includes(a.value)?(o(),r("div",ne,s[3]||(s[3]=[n("svg",{class:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):p("",!0)],10,re))),128)),e.addable&&l.value.trim()&&!u.value.some(a=>a.label.toLowerCase()===l.value.toLowerCase())?(o(),r("div",{key:0,onClick:A,class:"px-3 py-2 text-sm cursor-pointer hover:bg-gray-100 border-t flex items-center text-primary"},[y(c(J),{class:"mr-2 h-4 w-4"}),C(' Add "'+d(l.value.trim())+'" ',1)])):L.value.length===0&&(!e.addable||!l.value.trim())?(o(),r("div",ie,d(l.value.trim()?"No results found":"Type to search..."),1)):p("",!0)])])):p("",!0)],512),(v=e.form.errors)!=null&&v[e.model]?(o(),g(I,{key:1,message:e.form.errors[e.model]},null,8,["message"])):p("",!0)])}}});export{he as _};
