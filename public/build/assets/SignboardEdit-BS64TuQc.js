import{d as N,x as G,r as b,m as A,v as $,c,o as d,a as o,u as r,g as q,w as L,b as e,e as v,t as m,F as x,k as U,h as S,f as V}from"./app-AYUAItGV.js";import{t as D,a as T}from"./helpers-D5H0wNSX.js";import{_}from"./InputText.vue_vue_type_script_setup_true_lang-BUav05rB.js";import{_ as C,I as W}from"./InputSelect.vue_vue_type_script_setup_true_lang-BZ9Zrb3O.js";import{c as z,X as h,_ as J,L as X}from"./index-HGAjEnE_.js";import{B as H,_ as K}from"./Layout.vue_vue_type_script_setup_true_lang-CWMenEid.js";import{g as R}from"./meta-o3_ofRgN.js";import{M as Q}from"./map-pin-DqCQyg83.js";import{U as Y}from"./upload-Dz-eYaBN.js";import{P as I}from"./plus-Dc1J1Bsn.js";import{C as Z}from"./check-BkAedqbK.js";import"./InputError.vue_vue_type_script_setup_true_lang-B2muTTzz.js";import"./Input.vue_vue_type_script_setup_true_lang-BrgIm8nW.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-B04inPsl.js";import"./VisuallyHidden-CutucHug.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=z("PenLineIcon",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),se={class:"w-full bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50"},te={class:"bg-white border-b border-gray-200 shadow-sm"},re={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},oe={class:"flex items-center space-x-3"},ae={class:"p-2 bg-primary rounded-lg"},le={class:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ie={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},de={class:"lg:col-span-2 space-y-6"},ne={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ce={class:"flex items-center space-x-3 mb-6"},ue={class:"p-2 bg-primary rounded-lg"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},me={class:"md:col-span-2"},pe={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},be={class:"flex items-center space-x-3 mb-6"},_e={class:"p-2 bg-primary rounded-lg"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},fe={class:"space-y-6"},ve={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},xe={class:"flex items-center space-x-3 mb-4"},ye={class:"p-2 bg-primary rounded-lg"},we={class:"relative"},ke={class:"relative rounded-lg border-2 border-dashed border-gray-300 p-6 transition-all duration-200 hover:border-primary hover:bg-blue-50/50 group"},Le={key:0,class:"text-center"},Ue={key:1,class:"relative"},Se=["src"],Ce={key:0,class:"mt-2 text-sm text-red-600 flex items-center space-x-1"},Re={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Ie={class:"flex items-center justify-between mb-4"},Be={class:"flex items-center space-x-3"},Pe={class:"p-2 bg-primary rounded-lg"},je={class:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded-full"},Oe={class:"space-y-4"},Me={class:"relative rounded-lg border-2 border-dashed border-gray-300 p-4 transition-all duration-200 hover:border-primary hover:bg-indigo-50/50 group"},Ee={class:"text-center"},Fe={key:0,class:"grid grid-cols-2 gap-3"},Ne=["src"],Ge=["onClick"],Ae={class:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-black/50 rounded text-white text-xs"},$e={key:1,class:"space-y-1"},qe={key:0,class:"text-sm text-red-600 flex items-center space-x-1"},Ve={class:"mt-8"},De={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},Te={class:"flex items-center justify-between"},ls=N({__name:"SignboardEdit",props:{signboard:{}},setup(B){const n=B,t=G({business_id:"",region_id:"",town:"",street:"",landmark:"",blk_number:"",gps:"",featured_image:null,gallery_images:[],removed_gallery_urls:[]}),u=b(n.signboard.featured_url||null),p=b([...n.signboard.gallery_urls||[]]),g=b([]),y=A(()=>Object.keys(t.errors).filter(a=>a.startsWith("gallery_images.")).map(a=>t.errors[a])),w=b([]),k=b([]);$(async()=>{var l,i;t.business_id=String(n.signboard.business_id),t.region_id=String(n.signboard.region_id),t.town=n.signboard.town||"",t.street=n.signboard.street||"",t.landmark=n.signboard.landmark||"",t.blk_number=n.signboard.blk_number||"",t.gps=n.signboard.gps||"",g.value=(n.signboard.gallery_urls||[]).map((f,F)=>({url:f,isOriginal:!0,originalIndex:F}));const[a,s]=await Promise.all([R("regions"),R("authBusinesses")]);w.value=((l=a.metadata)==null?void 0:l.regions)??[],k.value=((i=s.metadata)==null?void 0:i.businesses)??[]});const P=a=>{var l;const s=((l=a.target.files)==null?void 0:l[0])||null;t.featured_image=s,u.value&&u.value.startsWith("blob:")&&URL.revokeObjectURL(u.value),u.value=s?URL.createObjectURL(s):null},j=()=>{t.featured_image=null,u.value&&u.value.startsWith("blob:")&&URL.revokeObjectURL(u.value),u.value=null},O=a=>{(a.target.files?Array.from(a.target.files):[]).forEach(l=>{const i=URL.createObjectURL(l);t.gallery_images.push(l),g.value.push({url:i,isOriginal:!1})}),p.value=g.value.map(l=>l.url)},M=a=>{const s=g.value[a];if(s.isOriginal)t.removed_gallery_urls.push(s.url);else{const l=s.url;URL.revokeObjectURL(l);const i=g.value.slice(0,a).filter(f=>!f.isOriginal).length;i<t.gallery_images.length&&t.gallery_images.splice(i,1)}g.value.splice(a,1),p.value=g.value.map(l=>l.url)},E=()=>{t.post(route("my-signboards.update",n.signboard.id),{forceFormData:!0,onSuccess:a=>{const s=a.props.message;a.props.success?(D(s),t.removed_gallery_urls=[]):T(s)},onError:a=>{},preserveScroll:!0})};return(a,s)=>(d(),c(x,null,[o(r(q),{title:"Edit Signboard"}),o(K,null,{default:L(()=>[e("div",se,[e("div",te,[e("div",re,[e("div",oe,[e("div",ae,[o(r(ee),{class:"h-6 w-6 text-white"})]),s[0]||(s[0]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Edit Signboard"),e("p",{class:"text-sm text-gray-600 mt-1"},"Update your signboard listing information")],-1))])])]),e("div",le,[e("div",ie,[e("div",de,[e("div",ne,[e("div",ce,[e("div",ue,[o(r(H),{class:"h-5 w-5 text-white"})]),s[1]||(s[1]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Business Information",-1))]),e("div",ge,[e("div",me,[o(C,{label:"Select Business",form:r(t),model:"business_id",options:k.value,required:"",searchable:""},null,8,["form","options"])]),o(C,{label:"Region",form:r(t),model:"region_id",options:w.value,required:"",searchable:""},null,8,["form","options"]),o(_,{form:r(t),label:"Town",model:"town",required:""},null,8,["form"])])]),e("div",pe,[e("div",be,[e("div",_e,[o(r(Q),{class:"h-5 w-5 text-white"})]),s[2]||(s[2]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Location Details",-1))]),e("div",he,[o(_,{form:r(t),label:"Street Address",model:"street",placeholder:"e.g., Main Street"},null,8,["form"]),o(_,{form:r(t),label:"Landmark",model:"landmark",required:"",placeholder:"e.g., Near Central Mall"},null,8,["form"]),o(_,{form:r(t),label:"Block Number",model:"blk_number",placeholder:"e.g., Block A"},null,8,["form"]),o(_,{form:r(t),label:"GPS Coordinates",model:"gps",placeholder:"e.g., 5.6037, -0.1870"},null,8,["form"])])])]),e("div",fe,[e("div",ve,[e("div",xe,[e("div",ye,[o(r(W),{class:"h-5 w-5 text-white"})]),s[3]||(s[3]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Featured Image",-1))]),e("div",we,[e("div",ke,[e("input",{type:"file",accept:"image/*",onChange:P,class:"absolute inset-0 h-full w-full cursor-pointer opacity-0"},null,32),u.value?(d(),c("div",Ue,[e("img",{src:u.value,class:"w-full h-40 rounded-lg object-cover"},null,8,Se),e("button",{type:"button",onClick:j,class:"absolute top-2 right-2 p-1 bg-red-100 hover:bg-red-200 rounded-full shadow-lg transition-colors duration-200"},[o(r(h),{class:"h-4 w-4 text-red-600"})]),s[5]||(s[5]=e("div",{class:"absolute bottom-2 left-2 px-2 py-1 bg-black/50 rounded text-white text-xs"}," Featured ",-1))])):(d(),c("div",Le,[o(r(Y),{class:"mx-auto h-12 w-12 text-gray-400 group-hover:text-primary transition-colors duration-200"}),s[4]||(s[4]=e("div",{class:"mt-4"},[e("p",{class:"text-sm font-medium text-gray-900"},"Upload featured image"),e("p",{class:"text-xs text-gray-500 mt-1"},"PNG, JPG up to 10MB")],-1))]))]),r(t).errors.featured_image?(d(),c("p",Ce,[o(r(h),{class:"h-4 w-4"}),e("span",null,m(r(t).errors.featured_image),1)])):v("",!0)])]),e("div",Re,[e("div",Ie,[e("div",Be,[e("div",Pe,[o(r(I),{class:"h-5 w-5 text-white"})]),s[6]||(s[6]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Gallery Images",-1))]),e("span",je,m(p.value.length)+" uploaded ",1)]),e("div",Oe,[e("div",Me,[e("input",{type:"file",multiple:"",accept:"image/*",onChange:O,class:"absolute inset-0 h-full w-full cursor-pointer opacity-0"},null,32),e("div",Ee,[o(r(I),{class:"mx-auto h-8 w-8 text-gray-400 group-hover:text-primary transition-colors duration-200"}),s[7]||(s[7]=e("p",{class:"text-sm font-medium text-gray-700 mt-2"},"Add more images",-1)),s[8]||(s[8]=e("p",{class:"text-xs text-gray-500"},"Multiple selection supported",-1))])]),p.value.length?(d(),c("div",Fe,[(d(!0),c(x,null,U(p.value,(l,i)=>(d(),c("div",{key:i,class:"relative group"},[e("img",{src:l,class:"w-full h-24 rounded-lg object-cover border border-gray-200"},null,8,Ne),e("button",{type:"button",onClick:f=>M(i),class:"absolute top-1 right-1 p-1 bg-red-100 hover:bg-red-200 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-200"},[o(r(h),{class:"h-3 w-3 text-red-600"})],8,Ge),e("div",Ae,m(i+1),1)]))),128))])):v("",!0),r(t).errors.gallery_images||y.value.length?(d(),c("div",$e,[r(t).errors.gallery_images?(d(),c("p",qe,[o(r(h),{class:"h-4 w-4"}),e("span",null,m(r(t).errors.gallery_images),1)])):v("",!0),(d(!0),c(x,null,U(y.value,(l,i)=>(d(),c("p",{key:i,class:"text-sm text-red-600 flex items-center space-x-1"},[o(r(h),{class:"h-4 w-4"}),e("span",null,m(l),1)]))),128))])):v("",!0)])])])]),e("div",Ve,[e("div",De,[e("div",Te,[s[9]||(s[9]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"These information will appear to the public."),e("p",{class:"text-sm text-gray-600 mt-1"},"Review your information and submit when ready")],-1)),o(r(J),{disabled:r(t).processing,onClick:E,class:"px-8 py-3 bg-gradient-to-r from-primary to-primary hover:from-primary hover:to-orange-300 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"},{default:L(()=>[r(t).processing?(d(),S(r(X),{key:0,class:"mr-2 h-5 w-5 animate-spin"})):(d(),S(r(Z),{key:1,class:"mr-2 h-5 w-5"})),V(" "+m(r(t).processing?"Updating Signboard...":"Update Signboard"),1)]),_:1},8,["disabled"])])])])])])]),_:1})],64))}});export{ls as default};
